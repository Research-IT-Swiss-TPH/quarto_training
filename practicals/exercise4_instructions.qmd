---
title: ⭐⭐ Add dynamic elements to reports
subtitle: 📋 Instructions
author:
  - name:
      given: Hélène
      family: Langet
    affiliations:
      - name: Swiss TPH Research-IT
    orcid: 0000-0002-6758-2397
    email: helene.langet@swisstph.ch
license: "CC-BY"
date: last-modified
editor: source

format:
  html:
    default: true
    embed-resources: true
    code-link: true
    theme: cosmo
    toc: true
    number-sections: true
    anchor-sections: true
    title-block-banner: true
    comments:
      hypothesis: 
        theme: classic
    other-links:
      - text: df1.RData
        href: df1.RData
      - text: swisstph_template.docx
        href: swisstph_template.docx
      - text: ✅ Step-by-step correction
        href: ../correction/exercise4_step_by_step_correction.html
    code-links:
      - text: exercise4.qmd
        icon: file-code
        href: https://github.com/Research-IT-Swiss-TPH/quarto_training/blob/main/practicals/exercise4.qmd
    format-links: [pdf]
  docx:
    default: true
    toc: true
  pdf:
    default: true
    toc: true
    number-sections: true
    
execute:
  echo: fenced
  warning: false
    
resources:
  - exercise3_instructions.pdf
  - swisstph_template.docx
  - df1.RData
---

This exercise builds on the previous exercise where you learnt to [build a simple MS Word report ⭐](./exercise3_instructions.html).

## Objectives 🎯

-   Open the Quarto document `exercise4.qmd` in RStudio, or continue working on the Quarto notebook you used to generate a simple MS Word report in the previous [exercise](./exercise3_instructions.html);
-   All text formatted in bold is a placeholder and should be replaced with appropriate automated calculations or cross-references.
-   Complete each of the following tasks and render the document after each task or set of tasks to track your progress.

## Improve navigation and readability

-   [ ] Insert a table of contents to the rendered MS Word document;
-   [ ] Automatically number the different sections of the rendered MS Word document;
-   [ ] Configure the table of contents to only display two levels of section headings.

::: callout-tip
-   See Quarto documentation about [table of contents](https://quarto.org/docs/output-formats/ms-word.html#table-of-contents)
:::

## Implement dynamic calculations

-   [ ] Change the date `2023-12-31` to the date at which the MS Word document was last rendered;
- [ ] Format the date at which the MS Word document was last rendered to display it with the format `December 31, 2023`;

::: callout-tip
-   See Quarto documentation about [date formatting](https://quarto.org/docs/reference/dates.html#date-formatting)
-   See Quarto documentation about [dynamic dates](https://quarto.org/docs/reference/dates.html#date-parsing)
:::

-   [ ] Replace the placeholder text in bold with the automated calculation of the outbreak start and end dates ;

> "*The outbreak ran from **date** to **date***"

-   [ ] Replace the placeholder text in bold with the automated calculation of the number of cases, confirmed cases and deaths.

> "*Over the studied period, there were **N** cases, including **N** confirmed cases and **N** confirmed deaths.*"

::: callout-tip
-   See Quarto documentation about [inline code](https://quarto.org/docs/computations/inline-code.html)
:::

## Reference publication-ready tables

#### Table 1 {.unnumbered}

-   [ ] Assign a label to the table summarising the demographic characteristics and outcome frequency of all cases;
-   [ ] Replace the placeholder text in bold with a cross-reference to the table.

> "***cross-reference** provides a summary of the demographic characteristics and the outcome proportion for the overall population*"

#### Table 2 {.unnumbered}

-   [ ] Assign a label to the table summarising the demographic characteristics of individuals who died versus those who are still alive;
-   [ ] Replace the placeholder text in bold with a cross-reference to the table.

> "*while **cross-reference** compares the demographic characteristics of individuals who died versus those who are still alive*"

#### Table 3 {.unnumbered}

-   [ ] Assign a label to the table summarizing the odds ratios from the logistic regression model;
-   [ ] Replace the placeholder text in bold with a cross-reference to the table

> "The results of the logistic regression model are summarized in the formatted regression table, which is presented in **cross-reference**."


::: callout-tip
-   See [Quarto documentation about table cross-references](https://quarto.org/docs/authoring/tables.html#cross-references)
:::

## Customise figures

#### Figure 1 {.unnumbered}

-   [ ] Assign a label to the figure ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the figure ;

> "***cross-reference** illustrates the outbreak's progression, which can be divided into distinct phases.*"

-   [ ] Adjust the dimensions of the figure until you are happy with them

::: callout-tip
-   See [Quarto documentation about figure cross-references](https://quarto.org/docs/authoring/cross-references.html#computations)
-   See [Quarto documentation about figure options](https://quarto.org/docs/computations/execution-options.html#figure-options)
:::

## Code

#### Table 3 {.unnumbered}

-   [ ] Add a caption to the code chunk for your R implementation of the logistic regression (and only this code chunk) in the rendered MS Word document ;
-   [ ] Assign a label to the code chunk for your R implementation of the logistic regression (and only this code chunk) in the rendered MS Word document ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the code chunk.

::: callout-tip
-   See [Quarto documentation about code chunk cross-references](https://quarto.org/docs/authoring/cross-references.html#code-listings)
:::

## Add references

::: callout-tip
-   See [Quarto documentation about citations](https://quarto.org/docs/authoring/citations.html)
:::

-   [ ] Add the bibliography file `my_biblio.bib` to your MS Word rendered report ;
-   [ ] Cite the reference `text` in your MS Word rendered report ;
-   [ ] Create your own bibliography file and apply it to your MS Word rendered report ;

## Finalise your MS Word report

::: callout-tip
See [Quarto documentation about Word templates](https://quarto.org/docs/output-formats/ms-word-templates.html)
:::

-   [ ] Apply the Swiss TPH template `swisstph_template.docx` to your MS Word rendered report ;
-   [ ] Create your own template and apply it to your MS Word rendered report.
