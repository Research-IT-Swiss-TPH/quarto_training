---
title: "Quarto training for R - Exercise 3"
author: Unknown author
editor: visual
format: html
---

```{r}
load(file = "../data/df1.RData")
```

```{r}
df <- df |>
  dplyr::mutate(dplyr::across(c(sex, confirmed, death),
                              as.factor))
```

## Overview

```{r}
start_date <- min(df$date)
end_date <- max(df$date)
```

```{r}
period_start <- start_date
period_end <- end_date
```

```{r}
subdf <- df |>
  dplyr::filter(date >= period_start & date <= period_end)
```

The outbreak ran from **calculated date** to **calculated date**. This report covers the period **calculated date** to **calculated date**. Over the studied period, there were **calculated N** cases, including **calculated N** confirmed cases and **calculated N** confirmed deaths.

**cross-reference table** provides a summary of the overall population characteristics, while Table **cross-reference table** compares the characteristics of individuals who died versus those who are still alive.

```{r}

```

```{r}

```

## Outbreak evolution

**cross-reference figure** illustrates the outbreak's progression, which can be divided into distinct phases.

```{r}
# Aggregate the data to get the weekly count of all cases, confirmed cases and deaths
weekly_data <- subdf |>
  dplyr::group_by(week) |>
  dplyr::summarise(count = dplyr::n(),
                   confirmed_count = sum(confirmed == "1"),
                   death_count = sum(death == "1"))

# Plot the weekly count of all cases, confirmed cases and deaths
weekly_data |>
  ggplot2::ggplot(ggplot2::aes(x = week)) +
  ggplot2::geom_line(ggplot2::aes(y     = count,
                                  color = "All cases"),
                     size = 1) +
  ggplot2::geom_line(ggplot2::aes(y     = confirmed_count,
                                  color = "Confirmed cases"),
                     size = 1) +
  ggplot2::geom_line(ggplot2::aes(y     = death_count,
                                  color = "Confirmed deaths"),
                     size = 1) +
  ggplot2::labs(title = "Weekly count of all cases, confirmed cases and deaths",
                x     = "Week",
                y     = "Count",
                color = "Legend")
```

## Logistic regression model

In this section, we build and evaluate a logistic regression model to understand the relationship between certain variables and the likelihood of death among confirmed cases.

The logistic regression model uses `death` as the reponse variable, and `bmi` and `age` as predictor variables. It is implemented in R as shown in the code chunk referenced by **cross-reference code chunk**.

```{r}

```

The results of the logistic regression model are summarized in the formatted regression table, which is presented in **cross-reference table**.

```{r}

```

## Appendix

The dataset includes the following variables:

-   `age` = age of the individual (continuous variable) ;
-   `sex` = sex of the individual (binary variable: 1 = male, 2 = female) ;
-   `bmi` = Body Mass Index (BMI) of the individual (continuous variable) ;
-   `confirmed` = flag of confirmed cases (binary variable: 0 = no, 1 = yes)
-   `death` = death outcome (binary variable: 0 = alive, 1 = died)

```{r}
subdf |>
  skimr::skim()
```
