---
title: ‚≠ê Create a simple Word report
subtitle: üìã Instructions
author:
  - name:
      given: H√©l√®ne
      family: Langet
    affiliations:
      - name: Swiss TPH Research-IT
    orcid: 0000-0002-6758-2397
    email: helene.langet@swisstph.ch
license: "CC-BY"
date: last-modified
editor: source

format:
  html:
    default: true
    toc-depth: 2
    comments:
      hypothesis: 
        theme: classic
    other-links:
      - text: üóÑÔ∏è df1.RData
        href: df1.RData
      - text: ‚úÖ Step-by-step correction
        href: ../correction/exercise3_step_by_step_correction.html
    code-links:
      - text: exercise3.qmd
        icon: file-code
        href: https://github.com/Research-IT-Swiss-TPH/quarto_training/blob/main/practicals/exercise3.qmd
    format-links: [pdf]
  pdf:
    default: true
    toc: true
    toc-depth: 2
    number-sections: true
    code-block-bg: true
    code-block-border-left: "#c03427"
    include-in-header: 
       text: |
         \usepackage{fvextra}
         \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
    include-before-body:
      text: |
        \RecustomVerbatimEnvironment{verbatim}{Verbatim}{
        showspaces = false,
        showtabs = false,
        breaksymbolleft={},
        breaklines}
    
execute:
  echo: fenced
  warning: false
    
resources:
  - exercise3_instructions.pdf
  - df1.RData
---

## Objectives üéØ

-   You are tasked with generating a simple analytically reproducible report on a fictitious outbreak.
-   Download the files `df1.RData` and `exercise3.qmd` using the links provided on the right-hand side of this page. For simplicity, please put these two files under the same folder and open the Quarto notebook in RStudio.
- Complete each of the following tasks and render the document after each task or set of tasks to track your progress.
-   The final output should be a Microsoft (MS) Word report named `exercise3.docx`, containing all required tables, figures and corresponding captions.

## Setup basic elements of the Quarto notebook

-   [ ] Update the title of the Quarto notebook ;
-   [ ] Put your name as author of the Quarto notebook ;
-   [ ] Add the date `2023-12-31` to the Quarto notebook ;
-   [ ] Change the output format to generate a MS Word document ;
-   [ ] Configure the Quarto notebook to hide code in the rendered document ;
-   [ ] Configure the Quarto notebook to hide warnings in the rendered document.

::: callout-tip
-   See Quarto documentation about [MS Word options](https://quarto.org/docs/reference/formats/docx.html)
-   See Quarto documentation about [execution options](https://quarto.org/docs/reference/formats/docx.html#execution)
:::

## Create publication-ready summary statistics tables

#### Table 1 {.unnumbered}

- [ ] Create a table summarising the demographic characteristics and outcome frequency of all cases ;
- [ ] Add a caption to the table.

```{r}
#Table 1
#Generate a summary table displaying population characteristics

```

#### Table 2 {.unnumbered}

-   [ ] Create a table summarising the demographic characteristics of individuals who died versus those who are still alive ;
-   [ ] Add a caption to the table.

```{r}
#Table 2
#Generate a summary table comparing the demographic characteristics of individuals who died versus those who are still alive

```

::: callout-tip
-   See `gtsummary` documentation for creating [formatted summary tables](https://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html)
-   See [`tbl-cap`](https://quarto.org/docs/authoring/tables.html#computations) option to add a caption to a table generated by an executable code chunk

Other R packages for working with and customising tables include [flextable](https://davidgohel.github.io/flextable/) and [gt](https://gt.rstudio.com/)
:::

## Create publication-ready figures

#### Figure 1 {.unnumbered}

-   [ ] Add a caption to the figure;
-   [ ] Beautify the plot using `ggplot` options.

```{r}
#| echo: false
#Load the dataset stored in the "df1.RData" file
load(file = "df1.RData")
```

```{r}
#| echo: false
#Convert the 'sex', 'confirmed', and 'death' columns from their current data type to factors
df <- df |>
  dplyr::mutate(dplyr::across(c(sex, confirmed, death),
                              as.factor))
```

```{r}
#| echo: false
#Identify the start and end dates of the outbreak by finding the minimum and maximum values in the 'date' column
start_date <- min(df$date)
end_date <- max(df$date)
```

```{r}
#| echo: false
#Define the period of interest for the report
period_start <- start_date
period_end <- end_date
```

```{r}
#| echo: false
#Filter the data frame to include only the cases that occurred within the defined period
subdf <- df |>
  dplyr::filter(date >= period_start & date <= period_end)
```

```{r}
#Figure 1
#Aggregate the data to get the weekly count of all cases, confirmed cases and deaths
weekly_data <- subdf |>
  dplyr::group_by(week) |>
  dplyr::summarise(count = dplyr::n(),
                   confirmed_count = sum(confirmed == "1"),
                   death_count = sum(death == "1"))

#Plot the weekly count of all cases, confirmed cases and deaths
weekly_data |>
  ggplot2::ggplot(ggplot2::aes(x = week)) +
  ggplot2::geom_line(ggplot2::aes(y = count,
                                  color = "All cases"),
                     size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = confirmed_count,
                                  color = "Confirmed cases"),
                     size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = death_count,
                                  color = "Confirmed deaths"),
                     size = 1) +
  ggplot2::labs(title = "Weekly count of all cases, confirmed cases and deaths",
                x     = "Week",
                y     = "Count",
                color = "Legend")
```

::: callout-tip
-   see [`fig-cap`](https://quarto.org/docs/computations/execution-options.html#caption-and-alt-text) option to add a caption to a figure generated by an executable code chunk;
:::

## Present statistical models and results

-   [ ] Implement a logistic regression model based on the description provided in the Quarto notebook;
-   [ ] Display the code chunk with your R implementation of the logistic regression (and only display this code chunk) in the rendered MS Word document.

```{r}
#Logistic regression model

```

#### Table 3 {.unnumbered}

-   [ ] Create a table summarizing the odds ratios from the logistic regression model;
-   [ ] Add a caption to the table.

```{r}
#Table 3

```

::: callout-tip
-   See `gtsummary` documentation for creating [formatted tables of regression model results](https://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html)
:::

Ready to take it further? Once you have completed this exercise, you can [add dynamic elements to your report ‚≠ê‚≠ê](./exercise4_instructions.html).
