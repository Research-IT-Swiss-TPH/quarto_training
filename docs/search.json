[
  {
    "objectID": "correction/exercise4_step_by_step_correction.html",
    "href": "correction/exercise4_step_by_step_correction.html",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "",
    "text": "This page provides a step-by-step correction for adding dynamic elements to a simple MS Word report."
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#improve-navigation-and-readability",
    "href": "correction/exercise4_step_by_step_correction.html#improve-navigation-and-readability",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "1 Improve navigation and readability",
    "text": "1 Improve navigation and readability\n---\ntitle: My outbreak report\nauthor: Helene Langet\ndate: \"2023-12-31\"\n\nformat:\n  docx:\n7    toc: true\n8    number-sections: true\n9    toc-depth: 2\n\nexecute:    \n  echo: false               \n  warning: false            \n---\n\n7\n\nThis enables a table of contents (toc) at the beginning of your rendered MS Word report, making it easier for readers to navigate through sections.\n\n8\n\nThis option automatically numbers all section headings (e.g., 1, 1.1, 1.2), providing a clear, hierarchical structure.\n\n9\n\nThis limits the table of contents to display only two levels of headings.\n\n\n\n\n\n\n\n\nImportant\n\n\n\n\nRemember that YAML is a whitespace-sensitive language where indentation determines the structure\n\nğŸš« Do NOT use tabsâ€”they are not recognized.\nâœ… Use two spaces per indentation level to ensure consistency and avoid errors.\n\nIn this example, the TOC settings are applied specifically to the Word document output. If you want these settings to apply to all output formats (like HTML or PDF), move them to a higher level in the YAML header.\nWhen you open the rendered MS Word document, you might see a warning message, as displayed below. Do not worry, this is completely normal and does not indicate an error. This message appears because the document contains dynamic fields, such as the table of contents, cross-references, or figure/table captions. Click â€œYesâ€ to ensure all references and the table of contents are properly updated. If you click â€œNo,â€ the document will still open, but some fields may not reflect the latest changes. This is a standard behavior in MS Word when working with dynamic content.\n\n\nThis document contains fields that may refer to other files. Do you want to update the fields in this document?"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#implement-dynamic-calculations",
    "href": "correction/exercise4_step_by_step_correction.html#implement-dynamic-calculations",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "2 Implement dynamic calculations",
    "text": "2 Implement dynamic calculations\n\n2.1 In the YAML header\n---\ntitle: My outbreak report\nauthor: Helene Langet\n10date: last-modified\n11date-format: long\n\nformat:\n  docx:\n    toc: true             \n    number-sections: true\n    toc-depth: 2\n\nexecute:    \n  echo: false               \n  warning: false             \n---\n\n10\n\nInstead of manually entering a date (e.g., 2023-12-31), this setting automatically updates the date to the last time the MS Word document was generated (but this does not reflect when the source Quarto document was last edited).\n\n11\n\nFormats the date to be displayed in a full, human-readable format December 31, 2023. This improves readability, making the report look more polished.\n\n\n\n\n2.2 In the Quarto notebook\n\nReplace the placeholder text in bold with the automated calculation of the outbreak start and end dates ;\n\n\nâ€œThe outbreak ran from date to dateâ€\n\n\nReplace the placeholder text in bold with the automated calculation of the number of cases, confirmed cases and deaths.\n\n\nâ€œOver the studied period, there were N cases, including N confirmed cases and N confirmed deaths.â€"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#reference-tables",
    "href": "correction/exercise4_step_by_step_correction.html#reference-tables",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "3 Reference tables",
    "text": "3 Reference tables\n\nTable 1\n\n```{r}\nlibrary(gtsummary)\n```\n\n\n```{r}\n14#| label: tbl-1\n#| tbl-cap: Population characteristics\n\n#Table 1\n#Generate a summary table displaying population characteristics\nsubdf |&gt;                               \n  dplyr::select(age,\n                sex,\n                bmi,\n                confirmed,\n                death) |&gt;\n  gtsummary::tbl_summary()           \n```\n\n\n14\n\nAssign a label to the table.\n\n\n\n\n\n\nTableÂ 1: Population characteristics\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 65,6691\n\n\n\n\nage\n50 (35, 65)\n\n\nsex\n\n\n\n\nÂ Â Â Â 1\n33,114 (50%)\n\n\nÂ Â Â Â 2\n32,555 (50%)\n\n\nbmi\n29 (21, 38)\n\n\nconfirmed\n\n\n\n\nÂ Â Â Â 0\n13,235 (20%)\n\n\nÂ Â Â Â 1\n52,434 (80%)\n\n\ndeath\n\n\n\n\nÂ Â Â Â 0\n64,455 (98%)\n\n\nÂ Â Â Â 1\n1,214 (1.8%)\n\n\n\n1 Median (IQR); n (%)\n\n\n\n\n\n\n\n\n\n\n\n\nReplace the placeholder text in bold with a cross-reference to the table ;\n\n@tbl-1 provides a summary of the demographic characteristics and the outcome proportion for the overall population.\n\nâ€œTableÂ 1 provides a summary of the demographic characteristics and the outcome proportion for the overall populationâ€\n\n\n\nTable 2\n\n```{r}\n17#| label: tbl-2\n16#| tbl-cap: Demographic characteristics of deceased vs. alive\n\n15subdf |&gt;\n  dplyr::select(sex,\n                age,\n                bmi,\n                death) |&gt;\n  gtsummary::tbl_summary(by = death) |&gt;\n  gtsummary::add_overall()\n```\n\n\n15\n\nCreate a table summarising the demographic characteristics of individuals who died versus those who are still alive.\n\n16\n\nAdd a caption to the table.\n\n17\n\nAssign a label to the table.\n\n\n\n\n\n\nTableÂ 2: Demographic characteristics of deceased vs.Â alive\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOverall, N = 65,6691\n0, N = 64,4551\n1, N = 1,2141\n\n\n\n\nsex\n\n\n\n\n\n\n\n\nÂ Â Â Â 1\n33,114 (50%)\n32,504 (50%)\n610 (50%)\n\n\nÂ Â Â Â 2\n32,555 (50%)\n31,951 (50%)\n604 (50%)\n\n\nage\n50 (35, 65)\n50 (35, 65)\n52 (37, 67)\n\n\nbmi\n29 (21, 38)\n29 (21, 38)\n34 (28, 41)\n\n\n\n1 n (%); Median (IQR)\n\n\n\n\n\n\n\n\n\n\n\n\nReplace the placeholder text in bold with a cross-reference to the table.\n\n@tbl-2 compares the demographic characteristics of individuals who died versus those who are still alive.\n\nâ€œâ€¦, while TableÂ 2 compares the demographic characteristics of individuals who died versus those who are still alive.â€\n\n\n\nTable 3"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#reference-figures",
    "href": "correction/exercise4_step_by_step_correction.html#reference-figures",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "4 Reference figures",
    "text": "4 Reference figures\n\nFigure 1\n\n```{r}\n18#| label: fig-1\n#| fig-cap: Weekly count of all cases, confirmed cases and deaths\n19#| fig-width: 8\n20#| fig-height: 4\n\n# Aggregate the data to get the weekly count of all cases, confirmed cases and deaths\nweekly_data &lt;- subdf |&gt;\n  dplyr::group_by(week) |&gt;\n  dplyr::summarise(count = dplyr::n(),\n                   confirmed_count = sum(confirmed == \"1\"),\n                   death_count = sum(death == \"1\"))\n\n# Plot the weekly cases, confirmed cases and deaths\nggplot2::ggplot(weekly_data, ggplot2::aes(x = week)) +\n  ggplot2::geom_line(ggplot2::aes(y = count,\n                                  color = \"All cases\"),\n                     size = 1) +\n  ggplot2::geom_line(ggplot2::aes(y = confirmed_count,\n                                  color = \"Confirmed cases\"),\n                     size = 1) +\n  ggplot2::geom_line(ggplot2::aes(y = death_count,\n                                  color = \"Confirmed deaths\"),\n                     size = 1) +\n  ggplot2::labs(x = \"Week\",\n                y = \"Count\",\n                color = \"Legend\") +\n  ggplot2::scale_color_manual(values = c(\"All cases\" = \"#440e54\",\n                                         \"Confirmed cases\" = \"#f8766d\",\n                                         \"Confirmed deaths\" = \"#128984\")) +\n  ggplot2::theme_minimal() +\n  ggplot2::theme(panel.grid.major.y = ggplot2::element_line(linewidth = 0.5, linetype = \"dashed\", color = \"grey\"),\n                 panel.grid.minor.y = ggplot2::element_line(linewidth = 0.5, linetype = \"dashed\", color = \"grey\"),\n                 panel.grid.major.x = ggplot2::element_blank(),\n                 panel.grid.minor.x = ggplot2::element_blank())\n```\n\n\n18\n\nAssign a label to the figure.\n\n19\n\nSet the width of the figure to 8 inches by using the fig-width option. This option can also be specified globally in the YAML header of the Quarto notebook.\n\n20\n\nSet the height of the figure to 4 inches by using the fig-height option. This option can also be specified globally in the YAML header of the Quarto notebook.\n\n\n\n\n\n\n\n\n\n\nFigureÂ 1: Weekly count of all cases, confirmed cases and deaths\n\n\n\n\n\n\nReplace the placeholder text in bold with a cross-reference to the figure.\n\nFigureÂ 1 illustrates the outbreakâ€™s progression, which can be divided into distinct phases.\n\nâ€œcross-reference illustrates the outbreakâ€™s progression, which can be divided into distinct phases.â€\n\n\nBeautify the plot using ggplot options"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#reference-code-chunks",
    "href": "correction/exercise4_step_by_step_correction.html#reference-code-chunks",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "5 Reference code chunks",
    "text": "5 Reference code chunks\nThe logistic regression model uses death as the response variable, and bmi and age as predictor variables. It is implemented in R as shown in the code chunk referenced by ListingÂ 1\n\n\n\n\nListingÂ 1: R code\n\n\n```{r}\n#| lst-label: lst-test\n#| lst-cap: R code\n\ncoeffs &lt;- glm(death ~ bmi + age,\n              subdf |&gt; dplyr::filter(confirmed == \"1\"),\n              family = binomial)\n```\n\n\n\n\n\nImplement a logistic regression model based on description in the Quarto document.\n\nThe results of the logistic regression model are summarized in the formatted regression table, which is presented in TableÂ 3.\n\n```{r}\n25#| label: tbl-3\n24#| tbl-cap: Formatted regression table\n\n23gtsummary::tbl_regression(coeffs, exponentiate = TRUE)\n```\n\n\n23\n\nCreate a table summarizing the odds ratios from the logistic regression model.\n\n24\n\nAdd a caption to the table.\n\n25\n\nAssign a label to the table.\n\n\n\n\n\n\nTableÂ 3: Formatted regression table\n\n\n\n\n\n\n\n\n\nCharacteristic\nOR1\n95% CI1\np-value\n\n\n\n\nbmi\n1.04\n1.03, 1.04\n&lt;0.001\n\n\nage\n1.00\n1.00, 1.01\n0.003\n\n\n\n1 OR = Odds Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\n\n\n\n\nReplace the placeholder text in bold with a cross-reference to the table ;\n\n\nâ€œThe results of the logistic regression model are summarized in the formatted regression table, which is presented in cross-reference.â€"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#add-references",
    "href": "correction/exercise4_step_by_step_correction.html#add-references",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "6 Add references",
    "text": "6 Add references"
  },
  {
    "objectID": "correction/exercise4_step_by_step_correction.html#format-ms-word-reports-with-styles",
    "href": "correction/exercise4_step_by_step_correction.html#format-ms-word-reports-with-styles",
    "title": "â­â­ Add dynamic elements to reports",
    "section": "7 Format MS Word reports with styles",
    "text": "7 Format MS Word reports with styles\n---\ntitle: My outbreak report\nauthor: Helene Langet\ndate: last-modified\ndate-format: long\n\nformat:\n  docx:\n23    reference-doc: swisstph_template.docx\n    toc: true\n    number-sections: true\n    toc-depth: 2\n\nexecute:    \n  echo: false               \n  warning: false\n---\n\n23\n\nApply the Swiss TPH template swisstph_template.docx to your MS Word rendered report. Here this means the Word document and Quarto document are located in the same folder. Otherwise you need to indicate the path relative to the QUarto notebook"
  }
]