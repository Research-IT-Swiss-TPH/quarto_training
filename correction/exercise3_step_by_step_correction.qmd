---
title:  ⭐ Build a MS Word report
subtitle: ✅ Step-by-step correction
author:
  - name:
      given: Hélène
      family: Langet
    affiliations:
      - name: Swiss TPH Research-IT
    orcid: 0000-0002-6758-2397
    email: helene.langet@swisstph.ch
license: "CC-BY"
date: last-modified
editor: source
lang: en-US

format:
  html:
    default: true
    embed-resources: true
    code-block-bg: true
    code-block-border-left: "#c03427"
    theme: cosmo
    toc: true
    number-sections: true
    anchor-sections: true
    title-block-banner: true
    comments:
      hypothesis: 
        theme: classic
    code-links:
      - text: Instructions
        href: ../practical/exercise3_instructions.html
    format-links: [pdf]
  pdf:
    default: true
    toc: true
    number-sections: true
    
execute:
  echo: fenced
  warning: false
    
resources:
  - exercise3_instructions.pdf
---

## Overall objective

This page shows a step-by-step correction of Exercise 3.

## Setup basic elements of the Quarto document

All these basic elements are part of the YAML header.

```{.yaml}
---
title: My outbreak report # <1>
author: Helene Langet     # <2>
date: "2023-12-31"        # <3>

format: docx              # <4>
echo: false               # <5>
warning: false            # <6>
---
```

1. Update the title of the Quarto document.
2. Put your name as author of the Quarto document.
3. Add the date `2023-12-31` to the Quarto document.
4. Change the output format to generate a MS Word document.
5. Configure the Quarto document to hide code in the rendered MS Word document.
6. Configure the Quarto document to hide warnings in the rendered MS Word document.



## Improve navigation and readability

-   [X] Insert a table of contents to the Quarto document ;

```{.yaml}
---
title: "My outbreak report"
author: Helene Langet
date: "2023-12-31"
editor: visual

format:
  docx:
    toc: true
---
```

-   [X] Automatically number the different sections of the Quarto document ;

```{.yaml}
---
format:
  docx:
    toc: true
    number-sections: true
---
```

-   [X] Configure the table of contents to only display two levels of section headings.

```{.yaml}
---
format:
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---
```

## Implement dynamic calculations

-   [ ] Change the date `2023-12-31` to the date at which the Quarto document was last modified, and format this date to display it with the format `December 31, 2023` ;

```{.yaml}
---
title: "My outbreak report"
author: Helene Langet
date: last-modified
date-format: long
---
```

```{r}
#| echo: false
# Load the dataset stored in the "df1.RData" file
load(file = "df1.RData")
```

```{r}
#| echo: false
# Convert the 'sex', 'confirmed', and 'death' columns from their current data type to factors
df <- df |>
  dplyr::mutate(dplyr::across(c(sex, confirmed, death),
                              as.factor))
```

```{r}
#| echo: false
# Identify the start and end dates of the outbreak by finding the minimum and maximum values in the 'date' column
start_date <- min(df$date)
end_date <- max(df$date)
```

```{r}
#| echo: false
# Define the period of interest for the report
period_start <- start_date
period_end <- end_date
```

```{r}
#| echo: false
# Filter the data frame to include only the cases that occurred within the defined period
subdf <- df |>
  dplyr::filter(date >= period_start & date <= period_end)
```

-   [ ] Replace the placeholder text in bold with the automated calculation of the outbreak start and end dates ;

> "*The outbreak ran from **date** to **date***"

-   [ ] Replace the placeholder text in bold with the automated calculation of the number of cases, confirmed cases and deaths.

> "*Over the studied period, there were **N** cases, including **N** confirmed cases and **N** confirmed deaths.*"

## Create and reference publication-ready tables

-   [X] Create a table summarising the demographic characteristics and outcome frequency of all cases

```{r}
subdf |>
  dplyr::select(age,
                sex,
                bmi,
                confirmed,
                death) |>
  gtsummary::tbl_summary()
```

-   [X] Add a caption to the table

```{r}
#| tbl-cap: Population characteristics

subdf |>
  dplyr::select(age,
                sex,
                bmi,
                confirmed,
                death) |>
  gtsummary::tbl_summary()
```

-   [X] Assign a label to the table ;

```{r}
#| label: tbl-1
#| tbl-cap: Population characteristics

subdf |>
  dplyr::select(age,
                sex,
                bmi,
                confirmed,
                death) |>
  gtsummary::tbl_summary()
```

-   [X] Replace the placeholder text in bold with a cross-reference to the table ;

`` @tbl-1 `` provides a summary of the demographic characteristics and the outcome proportion for the overall population.

> "*@tbl-1 provides a summary of the demographic characteristics and the outcome proportion for the overall population*"

::: {.content-visible when-format="revealjs"}

------------------------------------------------------------------------
:::

-   [ ] Create a table summarising the demographic characteristics of individuals who died versus those who are still alive ;
-   [ ] Add a caption to the table ;
-   [ ] Assign a label to the table ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the table.

> "*while **cross-reference** compares the demographic characteristics of individuals who died versus those who are still alive*"

## Customise figures

::: callout-tip
-   See [Quarto documentation about figure cross-references](https://quarto.org/docs/authoring/cross-references.html#computations)
-   See [Quarto documentation about figure options](https://quarto.org/docs/computations/execution-options.html#figure-options)
:::

-   [ ] Add a caption to the figure ;
-   [ ] Assign a label to the figure ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the figure ;

> "***cross-reference** illustrates the outbreak's progression, which can be divided into distinct phases.*"

-   [ ] Adjust the dimensions of the figure until you are happy with it
-   [ ] Beautify the plot using ggplot options

## Code

::: callout-tip
-   See [gtsummary documentation about formatted table of regression model results](https://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html)
-   See [Quarto documentation about code chunk cross-references](https://quarto.org/docs/authoring/cross-references.html#code-listings)
:::

-   [ ] Implement a logistic regression model based on description in the Quarto document ;
-   [ ] Create a table summarizing the odds ratios from the logistic regression model ;
-   [ ] Add a caption to the table ;
-   [ ] Assign a label to the table ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the table ;

> "The results of the logistic regression model are summarized in the formatted regression table, which is presented in **cross-reference**."

::: {.content-visible when-format="revealjs"}

------------------------------------------------------------------------
:::

-   [ ] Display the code chunk for your R implementation of the logistic regression (and only this code chunk) in the rendered MS Word document ;
-   [ ] Add a caption to the code chunk ;
-   [ ] Assign a label to the code chunk ;
-   [ ] Replace the placeholder text in bold with a cross-reference to the code chunk.

## Finalise your MS Word report

::: callout-tip
See [Quarto documentation about Word templates](https://quarto.org/docs/output-formats/ms-word-templates.html)
:::

-   [ ] Apply the Swiss TPH template `swisstph_template.docx` to your MS Word rendered report ;
-   [ ] Create your own template and apply it to your MS Word rendered report.
